{"ast":null,"code":"import _toConsumableArray from\"/home/oem/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/oem/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/oem/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/oem/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/oem/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/oem/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Service from'./Service';import editPNG from\"./img/edit.png\";import trashPNG from\"./img/trash.png\";import append from\"./img/plus.png\";var service=new Service();var ArticleRedactor=/*#__PURE__*/function(_Component){_inherits(ArticleRedactor,_Component);var _super=_createSuper(ArticleRedactor);function ArticleRedactor(props){var _this;_classCallCheck(this,ArticleRedactor);_this=_super.call(this,props);_this.deleteElement=_this.deleteElement.bind(_assertThisInitialized(_this));_this.appendElement=_this.appendElement.bind(_assertThisInitialized(_this));_this.temp_type_change=_this.temp_type_change.bind(_assertThisInitialized(_this));_this.publicateArticle=_this.publicateArticle.bind(_assertThisInitialized(_this));var params=_this.props.match.params;_this.state={article:[],id:params.pk,status:null,edit:null,temp_type:null};return _this;}_createClass(ArticleRedactor,[{key:\"componentDidMount\",value:function componentDidMount(){var self=this;service.getArticle({id:this.state.id}).then(function(result){self.setState({article:result});});}},{key:\"styleOfArticle\",value:function styleOfArticle(key){if(!key){}else if(key[1]===\"code\"){return/*#__PURE__*/React.createElement(\"div\",{key:key,className:\"article__code\"},key[0]);}else if(key[1]===\"text\"){return/*#__PURE__*/React.createElement(\"div\",{key:key,className:\"article__text\"},key[0]);}else if(key[1]===\"link\"){return/*#__PURE__*/React.createElement(\"div\",{key:key,className:\"article__link\"},/*#__PURE__*/React.createElement(\"a\",{href:key[2]},\" \",key[0]));}else if(key[1]===\"header\"){return/*#__PURE__*/React.createElement(\"div\",{key:key,className:\"article__header\"},key[0]);}}},{key:\"deleteElement\",value:function deleteElement(id){this.setState(function(_ref){var article=_ref.article;var newArray=[].concat(_toConsumableArray(article.slice(0,id)),_toConsumableArray(article.slice(id+1)));return{article:newArray};});}},{key:\"editElement\",value:function editElement(id){this.setState({edit:this.state.article[id],status:\"edit\",temp_type:this.state.article[id][1]});}},{key:\"appendElement\",value:function appendElement(id){if(id!==-2){this.setState({edit:this.state.article[id],status:\"append\",temp_type:null});}else{this.setState({edit:[],status:\"append\",temp_type:null});}}},{key:\"addBlock\",value:function addBlock(id){console.log(id);var type=this.state.temp_type;var textFromForm=document.getElementById(\"textInputFromRedaction\").value;var arr=this.state.article;console.log(arr);var temp_arr=[];console.log(type);if(type!==\"selected\"&&document.getElementById(\"textInputFromRedaction\").value!==\"\"){if(type===\"link\"){var link=document.getElementById(\"linkInputFromRedaction\").value;temp_arr=[textFromForm,type,link];document.getElementById(\"linkInputFromRedaction\").value=\"\";}else{temp_arr=[textFromForm,type];}if(-1!==id){arr=[].concat(_toConsumableArray(arr.slice(0,id)),[temp_arr],_toConsumableArray(arr.slice(id)));}else{arr.push(temp_arr);}document.getElementById(\"textInputFromRedaction\").value=\"\";this.setState({article:arr,status:null});console.log(arr);}else if(!type||type===\"selected\"){alert(\"Укажите тип блока\");}else if(!textFromForm||textFromForm===\"\"){alert(\"Заполните пожалуйста все поля\");}}},{key:\"redactionBlock\",value:function redactionBlock(id){console.log(id);var type=this.state.temp_type;var textFromForm=document.getElementById(\"textInputFromRedaction\").value;var arr=this.state.article;console.log(type);if(type!==\"selected\"&&document.getElementById(\"textInputFromRedaction\").value!==\"\"){if(type===\"link\"){var link=document.getElementById(\"linkInputFromRedaction\").value;arr[id]=[textFromForm,type,link];document.getElementById(\"linkInputFromRedaction\").value=\"\";}else{arr[id]=[textFromForm,type];}document.getElementById(\"textInputFromRedaction\").value=\"\";this.setState({article:arr,status:null});}else if(!type||type===\"selected\"){alert(\"Укажите тип блока\");}else if(!textFromForm||textFromForm===\"\"){alert(\"Заполните пожалуйста все поля\");}}},{key:\"styleOfRedactionInput\",value:function styleOfRedactionInput(moment){if(this.state.temp_type===\"link\"){return\"create-article__type-new-block-link form-control create-article__input\";}else{return\"create-article__non-display\";}}},{key:\"temp_type_change\",value:function temp_type_change(event){this.setState({temp_type:event.target.value});}},{key:\"publicateArticle\",value:function publicateArticle(){if(this.state.article[0][1]!==\"header\"){alert(\"Статья должна начинаться с Заголовока\");}else{this.setState({loading:true});var self=this;var raw={\"id\":this.state.id,\"article\":this.state.article};service.redactorArticle(raw).then(function(result){self.setState({loading:false});alert(\"Статья отредактирована, и на ходится на модерации, спасибо, удачного дня!)\");window.location.reload();});}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var params=this.props.match.params;if(params.pk!==this.state.opend){this.setState({opend:params.pk});}}},{key:\"render\",value:function render(){var _this2=this;if(this.state.status===\"edit\"){var moment=this.state.edit;return/*#__PURE__*/React.createElement(\"div\",{className:\"article__container\"},this.styleOfArticle(moment),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h3\",null,\" \\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \"),/*#__PURE__*/React.createElement(\"select\",{className:\"create-article__choose-type custom-select mr-sm-2 create-article__input\",id:\"inlineFormCustomSelect\",onChange:this.temp_type_change},/*#__PURE__*/React.createElement(\"option\",{value:\"selected\"},\"\\u0422\\u0438\\u043F \\u0431\\u043B\\u043E\\u043A\\u0430\"),/*#__PURE__*/React.createElement(\"option\",{value:\"header\"},\"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A\"),/*#__PURE__*/React.createElement(\"option\",{value:\"text\"},\"\\u0422\\u0435\\u043A\\u0441\\u0442\"),/*#__PURE__*/React.createElement(\"option\",{value:\"code\"},\"\\u041A\\u043E\\u0434\"),/*#__PURE__*/React.createElement(\"option\",{value:\"link\"},\"\\u0421\\u0441\\u044B\\u043B\\u043A\\u0430\")),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control create-article__input\",id:\"textInputFromRedaction\"}),/*#__PURE__*/React.createElement(\"input\",{className:this.styleOfRedactionInput(moment),id:\"linkInputFromRedaction\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"create-article__create-button\",onClick:function onClick(){return _this2.redactionBlock(_this2.state.article.indexOf(moment));}},\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u043E\\u043B\\u043D\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0431\\u043B\\u043E\\u043A\"));}else if(this.state.status===\"append\"){var _moment=this.state.edit;return/*#__PURE__*/React.createElement(\"div\",{className:\"article__container\"},this.styleOfArticle(_moment),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h3\",null,\" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \"),/*#__PURE__*/React.createElement(\"select\",{className:\"create-article__choose-type custom-select mr-sm-2 create-article__input\",id:\"inlineFormCustomSelect\",onChange:this.temp_type_change},/*#__PURE__*/React.createElement(\"option\",{value:\"selected\"},\"\\u0422\\u0438\\u043F \\u0431\\u043B\\u043E\\u043A\\u0430\"),/*#__PURE__*/React.createElement(\"option\",{value:\"header\"},\"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A\"),/*#__PURE__*/React.createElement(\"option\",{value:\"text\"},\"\\u0422\\u0435\\u043A\\u0441\\u0442\"),/*#__PURE__*/React.createElement(\"option\",{value:\"code\"},\"\\u041A\\u043E\\u0434\"),/*#__PURE__*/React.createElement(\"option\",{value:\"link\"},\"\\u0421\\u0441\\u044B\\u043B\\u043A\\u0430\")),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control create-article__input\",id:\"textInputFromRedaction\"}),/*#__PURE__*/React.createElement(\"input\",{className:this.styleOfRedactionInput(_moment),id:\"linkInputFromRedaction\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"create-article__create-button\",onClick:function onClick(){return _this2.addBlock(_this2.state.article.indexOf(_moment));}},\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u043E\\u043B\\u043D\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0431\\u043B\\u043E\\u043A\"));}else return/*#__PURE__*/React.createElement(\"div\",{className:\"article__container\"},this.state.article.map(function(moment){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{className:\"article__appendButton\",onClick:function onClick(){return _this2.appendElement(_this2.state.article.indexOf(moment));},alt:\"plus\",src:append}),_this2.styleOfArticle(moment),/*#__PURE__*/React.createElement(\"img\",{className:\"article__delButton\",alt:\"delete\",onClick:function onClick(){return _this2.deleteElement(_this2.state.article.indexOf(moment));},src:trashPNG}),/*#__PURE__*/React.createElement(\"img\",{className:\"article__editButton\",alt:\"edit\",onClick:function onClick(){return _this2.editElement(_this2.state.article.indexOf(moment));},src:editPNG}));}),/*#__PURE__*/React.createElement(\"img\",{className:\"article__appendButton\",onClick:function onClick(){return _this2.appendElement(-2);},alt:\"plus\",src:append}),/*#__PURE__*/React.createElement(\"div\",{className:\"create-article__uppend-button\",onClick:this.publicateArticle},\"\\u041E\\u043F\\u0443\\u0431\\u043B\\u0438\\u043A\\u043E\\u0432\\u0430\\u0442\\u044C \\u0441\\u0442\\u0430\\u0442\\u044C\\u044E\"));}}]);return ArticleRedactor;}(Component);export default ArticleRedactor;","map":{"version":3,"sources":["/home/oem/ServiceOfTutorials/frontend/src/ArticleRedactor.js"],"names":["React","Component","Service","editPNG","trashPNG","append","service","ArticleRedactor","props","deleteElement","bind","appendElement","temp_type_change","publicateArticle","params","match","state","article","id","pk","status","edit","temp_type","self","getArticle","then","result","setState","key","newArray","slice","console","log","type","textFromForm","document","getElementById","value","arr","temp_arr","link","push","alert","moment","event","target","loading","raw","redactorArticle","window","location","reload","prevProps","opend","styleOfArticle","styleOfRedactionInput","redactionBlock","indexOf","addBlock","map","editElement"],"mappings":"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","sourcesContent":["import React, { Component }  from 'react';\n\nimport  Service  from  './Service';\n\nimport  editPNG from \"./img/edit.png\";\nimport  trashPNG from \"./img/trash.png\";\nimport  append from \"./img/plus.png\"\n\nconst  service  =  new  Service();\n\nclass ArticleRedactor extends Component{\n\n  constructor(props) {\n    super(props);\n    this.deleteElement = this.deleteElement.bind(this)\n    this.appendElement = this.appendElement.bind(this)\n    this.temp_type_change = this.temp_type_change.bind(this)\n    this.publicateArticle = this.publicateArticle.bind(this)\n    const { match: { params } } = this.props;\n    this.state = {\n      article:  [],\n      id: params.pk,\n      status: null,\n      edit: null,\n      temp_type: null\n    };\n  }\n\n\n  componentDidMount(){\n    var  self  =  this;\n\n    service.getArticle({id: this.state.id}).then(function (result) {\n      self.setState({ article: result })\n    });\n  }\n\n  styleOfArticle(key) {\n    if(!key){\n\n    } else if (key[1] === \"code\") {\n      return  (<div key={key} className=\"article__code\">\n                {key[0]}\n              </div>)\n    } else if(key[1] === \"text\"){\n      return (<div key={key} className=\"article__text\">\n                {key[0]}\n              </div>)\n    } else if(key[1] === \"link\"){\n      return (<div key={key} className=\"article__link\">\n                <a href={key[2]}> {key[0]}</a>\n              </div>)\n    } else if(key[1] === \"header\"){\n      return (<div key={key} className=\"article__header\">\n                {key[0]}\n              </div>)\n    }\n  }\n  deleteElement(id) {\n    this.setState(({ article }) => {\n\n      const newArray = [\n        ...article.slice(0, id),\n        ...article.slice(id + 1)\n      ];\n\n      return {\n        article: newArray\n      };\n    });\n  };\n  editElement(id) {\n    this.setState({\n      edit: this.state.article[id],\n      status: \"edit\",\n      temp_type: this.state.article[id][1]\n    })\n  }\n  appendElement(id) {\n    if(id !== -2 ){\n      this.setState({\n        edit: this.state.article[id],\n        status: \"append\",\n        temp_type: null\n      })\n    } else {\n      this.setState({\n        edit: [],\n        status: \"append\",\n        temp_type: null\n      })\n    }\n\n  }\n  addBlock(id) {\n    console.log(id)\n    let type = this.state.temp_type\n    let textFromForm = document.getElementById(\"textInputFromRedaction\").value\n    let arr = this.state.article\n    console.log(arr)\n    let temp_arr = []\n    console.log(type)\n    if (type !== \"selected\" && document.getElementById(\"textInputFromRedaction\").value !== \"\") {\n        if (type === \"link\") {\n          let link = document.getElementById(\"linkInputFromRedaction\").value\n          temp_arr = [textFromForm, type, link]\n          document.getElementById(\"linkInputFromRedaction\").value = \"\"\n        } else {\n          temp_arr = [textFromForm, type]\n        }\n        if(-1 !== id){\n          arr = [\n            ...arr.slice(0, id),\n            ...[temp_arr],\n            ...arr.slice(id )\n          ];\n        } else {\n          arr.push(temp_arr)\n        }\n\n        document.getElementById(\"textInputFromRedaction\").value = \"\"\n        this.setState({\n          article: arr,\n          status: null\n        })\n        console.log(arr)\n    } \n    else if (!type || type === \"selected\"){\n      alert (\"Укажите тип блока\")\n    } \n    else if (!textFromForm || textFromForm === \"\") {\n      alert(\"Заполните пожалуйста все поля\")\n    }\n  }\n  redactionBlock(id) {\n    console.log(id)\n    let type = this.state.temp_type\n    let textFromForm = document.getElementById(\"textInputFromRedaction\").value\n    let arr = this.state.article\n    console.log(type)\n    if (type !== \"selected\" && document.getElementById(\"textInputFromRedaction\").value !== \"\") {\n        if (type === \"link\") {\n          let link = document.getElementById(\"linkInputFromRedaction\").value\n          arr[id]=[textFromForm, type, link]\n          document.getElementById(\"linkInputFromRedaction\").value = \"\"\n        } else {\n          arr[id]=[textFromForm, type]\n        }\n        document.getElementById(\"textInputFromRedaction\").value = \"\"\n        this.setState({\n          article: arr,\n          status: null\n        })\n    } \n    else if (!type || type === \"selected\"){\n      alert (\"Укажите тип блока\")\n    } \n    else if (!textFromForm || textFromForm === \"\") {\n      alert(\"Заполните пожалуйста все поля\")\n    }\n  }\n  styleOfRedactionInput(moment) {\n    if(this.state.temp_type === \"link\"){\n      return \"create-article__type-new-block-link form-control create-article__input\"\n    } else {\n      return \"create-article__non-display\"\n    }\n  }\n  temp_type_change(event) {\n    this.setState({ temp_type: event.target.value })\n  }\n\n\n  publicateArticle(){\n\n    if (this.state.article[0][1] !== \"header\") {\n      alert(\"Статья должна начинаться с Заголовока\")\n    } else{\n      this.setState({loading: true})\n      var  self  =  this;\n\n      var raw = {\n        \"id\": this.state.id,\n        \"article\": this.state.article\n      }\n      service.redactorArticle(raw).then(function (result) {\n        self.setState({loading:false})\n        alert(\"Статья отредактирована, и на ходится на модерации, спасибо, удачного дня!)\")\n        window.location.reload();\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const { match: { params } } = this.props;\n    if (params.pk !== this.state.opend) {\n      this.setState({opend: params.pk});\n    }\n  }\n\n  render() {\n    if(this.state.status === \"edit\"){\n      let moment = this.state.edit\n      return (\n        <div className=\"article__container\">\n\n        {this.styleOfArticle(moment)}\n        <br/>\n          <h3> Редактировать </h3>\n          <select className=\"create-article__choose-type custom-select mr-sm-2 create-article__input\" \n                  id=\"inlineFormCustomSelect\" \n                  onChange={this.temp_type_change}>\n            <option value=\"selected\">Тип блока</option>            \n            <option value=\"header\">Заголовок</option>\n            <option value=\"text\">Текст</option>\n            <option value=\"code\">Код</option>\n            <option value=\"link\">Ссылка</option>                                  \n          </select>\n          <input className=\"form-control create-article__input\" id=\"textInputFromRedaction\"/>\n          <input className={this.styleOfRedactionInput(moment)} id=\"linkInputFromRedaction\"/>\n          <div  className=\"create-article__create-button\"\n                onClick={() => this.redactionBlock(this.state.article.indexOf(moment))}> \n            Изменить заполненный блок\n          </div>                \n        </div> \n      )\n    } else if(this.state.status === \"append\"){\n      let moment = this.state.edit\n      return (\n        <div className=\"article__container\">\n\n        {this.styleOfArticle(moment)}\n        <br/>\n          <h3> Добавить </h3>\n          <select className=\"create-article__choose-type custom-select mr-sm-2 create-article__input\" \n                  id=\"inlineFormCustomSelect\" \n                  onChange={this.temp_type_change}>\n            <option value=\"selected\">Тип блока</option>            \n            <option value=\"header\">Заголовок</option>\n            <option value=\"text\">Текст</option>\n            <option value=\"code\">Код</option>\n            <option value=\"link\">Ссылка</option>                                  \n          </select>\n          <input className=\"form-control create-article__input\" id=\"textInputFromRedaction\"/>\n          <input className={this.styleOfRedactionInput(moment)} id=\"linkInputFromRedaction\"/>\n          <div  className=\"create-article__create-button\"\n                onClick={() => this.addBlock(this.state.article.indexOf(moment))}> \n            Изменить заполненный блок\n          </div>                \n        </div> \n      )\n    } else  return(\n      <div className=\"article__container\">\n        { \n          this.state.article.map( moment  =>\n            <div>\n              <img \n                className=\"article__appendButton\"\t      \t\t\n                onClick={() => this.appendElement(this.state.article.indexOf(moment))}\n                alt=\"plus\"\n                src={append}/>\n              {this.styleOfArticle(moment)}\n              <img \n                className=\"article__delButton\"     \n                alt=\"delete\"\n                onClick={() => this.deleteElement(this.state.article.indexOf(moment))}\n                src={trashPNG}/>\n              <img \n                className=\"article__editButton\"   \n                alt=\"edit\"\n                onClick={() => this.editElement(this.state.article.indexOf(moment))}\n                src={editPNG}/>   \n            </div>\n          )\n        }\n              <img \n                className=\"article__appendButton\"\t      \t\t\n                onClick={() => this.appendElement(-2)}\n                alt=\"plus\"\n                src={append}/>\n          <div  className=\"create-article__uppend-button\"\n                onClick={this.publicateArticle}> \n            Опубликовать статью \n          </div>\n      </div>\n    );\n  }\n}\n\nexport default ArticleRedactor;\n"]},"metadata":{},"sourceType":"module"}