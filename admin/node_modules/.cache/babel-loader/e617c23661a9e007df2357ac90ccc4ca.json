{"ast":null,"code":"import _classCallCheck from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Link}from'react-router-dom';import Service from'./Service';import{multilanguage,changeLanguage,loadLanguages}from\"redux-multilanguage\";import{connect}from'react-redux';import{FindForm}from'./FindCatalog.tsx';var service=new Service();function sortfunction(a,b){return a[0][3]-b[0][3];}var newArticlesSorting=function newArticlesSorting(catalog){var arr=[];catalog.map(function(global){return global.splice(1).map(function(first){return first[1].forEach(function(second){if(second[1]&&second[2]!==\"noDisplay\"){arr.push([[global[0],first[0]].concat(second)]);}});});});arr.sort(sortfunction);arr.reverse();return arr;};var PRENewArticles=/*#__PURE__*/function(_Component){_inherits(PRENewArticles,_Component);var _super=_createSuper(PRENewArticles);function PRENewArticles(props){var _this;_classCallCheck(this,PRENewArticles);_this=_super.call(this,props);_this.findClick=_this.findClick.bind(_assertThisInitialized(_this));var currentLanguageCode=_this.props.currentLanguageCode;var newArticles=[];if(localStorage.getItem('newArticles'+currentLanguageCode)){newArticles=JSON.parse(localStorage.getItem('newArticles'+currentLanguageCode));}_this.state={catalog:[],find:null,loading:false,NewArticles:newArticles};return _this;}_createClass(PRENewArticles,[{key:\"componentDidMount\",value:function componentDidMount(){var self=this;var currentLanguageCode=this.props.currentLanguageCode;service.getCatalog({leng:currentLanguageCode}).then(function(result){if(result){self.setState({catalog:result,loading:true});var arr=newArticlesSorting(self.state.catalog);self.setState({NewArticles:arr,loading:false});localStorage.setItem('newArticles'+currentLanguageCode,JSON.stringify(arr));}});}},{key:\"componentWillUpdate\",value:function componentWillUpdate(prevProps){var self=this;var currentLanguageCode=this.props.currentLanguageCode;console.log(prevProps.currentLanguageCode,currentLanguageCode);if(prevProps.currentLanguageCode!==currentLanguageCode){var locName='newArticles'+currentLanguageCode;if(localStorage.getItem(locName)){self.setState({catalog:JSON.parse(localStorage.getItem(locName))});}service.getCatalog({leng:prevProps.currentLanguageCode}).then(function(result){if(result){self.setState({catalog:result,loading:true});var arr=newArticlesSorting(self.state.catalog);self.setState({NewArticles:arr,loading:false});localStorage.setItem('newArticles'+currentLanguageCode,JSON.stringify(arr));}});}}},{key:\"catalog_finded\",value:function catalog_finded(temp){temp=temp.toLowerCase();var str=this.state.find?this.state.find.toLowerCase():null;return temp.indexOf(str)!==-1?\"catalog__finded-style\":\"\";}},{key:\"findClick\",value:function findClick(){this.setState({find:document.getElementById(\"catalog__input-find-group\").value});}},{key:\"modStyle\",value:function modStyle(second){if(second[2]&&second[2]===\"unmod\"){return\"catalog__second-level-unmod\";}else if(second[2]&&second[2]===\"noDisplay\"){return\"catalog__second-level-delete\";}else{return\"catalog_second-level\";}}},{key:\"modInfo\",value:function modInfo(second){if(second[2]&&second[2]===\"unmod\"){return\" (На проверке)\";}else if(second[2]&&second[2]===\"noDisplay\"){}}},{key:\"render\",value:function render(){var _this$props=this.props,strings=_this$props.strings,currentLanguageCode=_this$props.currentLanguageCode;console.log(currentLanguageCode);if(this.state.loading){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"cssload-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"cssload-zenith\"})));}else return/*#__PURE__*/React.createElement(\"div\",{className:\"catalog\"},/*#__PURE__*/React.createElement(\"h1\",null,\" \",strings[\"newArticles\"],\" \"),/*#__PURE__*/React.createElement(FindForm,{onAdd:this.FindFormHandler,strings:strings[\"find\"]}),/*#__PURE__*/React.createElement(\"div\",null),this.state.NewArticles.map(function(global){return/*#__PURE__*/React.createElement(\"div\",{className:\"newArticlesList__article\",key:global},/*#__PURE__*/React.createElement(Link,{className:\"newArticlesList__link\",to:\"/Article/\"+global[0][3]},global[0][2]),/*#__PURE__*/React.createElement(\"p\",{className:\"newArticlesList__context\"},global[0][1],\" (\",global[0][0],\")\"),/*#__PURE__*/React.createElement(\"h6\",{className:\"newArticlesList__context\"},\" \\u0440\\u0435\\u0439\\u0442\\u0438\\u043D\\u0433:  \",global[0][5]));}));}}]);return PRENewArticles;}(Component);var NewArticles=connect()(multilanguage(PRENewArticles));export default NewArticles;","map":{"version":3,"sources":["/home/oem/React/ServiceOfTutorials/frontend/src/NewArticlesList.js"],"names":["React","Component","Link","Service","multilanguage","changeLanguage","loadLanguages","connect","FindForm","service","sortfunction","a","b","newArticlesSorting","catalog","arr","map","global","splice","first","forEach","second","push","concat","sort","reverse","PRENewArticles","props","findClick","bind","currentLanguageCode","newArticles","localStorage","getItem","JSON","parse","state","find","loading","NewArticles","self","getCatalog","leng","then","result","setState","setItem","stringify","prevProps","console","log","locName","temp","toLowerCase","str","indexOf","document","getElementById","value","strings","FindFormHandler"],"mappings":"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","sourcesContent":["import React, { Component }  from 'react';\n\nimport { Link } from 'react-router-dom';\nimport  Service  from  './Service';\nimport { multilanguage, changeLanguage, loadLanguages} from \"redux-multilanguage\";\nimport  { connect } from 'react-redux'\n\nimport { FindForm } from './FindCatalog.tsx';\n\nconst  service  =  new  Service();\n\n\nfunction sortfunction(a, b){\n  return (a[0][3] - b[0][3])\n  }\nconst newArticlesSorting = (catalog) => {\n  let arr = []\n  catalog.map( global=>\n      global.splice(1).map( first => \n          first[1].forEach( second  => {\n              if(second[1] && second[2] !== \"noDisplay\"){\n                      arr.push([[global[0], first[0]].concat(second)])\n              }\n          })   \n      )\n  )\n  arr.sort(sortfunction)\n  arr.reverse()\n  return arr\n}\n\nclass PRENewArticles extends Component{\n  constructor(props) {\n    super(props);\n    this.findClick = this.findClick.bind(this)\n\n    const { currentLanguageCode } = this.props;\n    let newArticles = []\n    if(localStorage.getItem('newArticles' + currentLanguageCode )){\n      newArticles = JSON.parse(localStorage.getItem('newArticles' + currentLanguageCode ))\n    }\n    this.state = {\n      catalog: [],\n      find: null,\n      loading: false,\n      NewArticles: newArticles,\n    }\n  }\n\n\n  componentDidMount(){\n    var  self  =  this;\n    const { currentLanguageCode } = this.props;\n    service.getCatalog({ leng: currentLanguageCode }).then(function (result) {\n      if (result) {\n        self.setState({ catalog: result, loading: true })\n\n        let arr = newArticlesSorting(self.state.catalog)\n        self.setState({NewArticles: arr, loading: false})\n        localStorage.setItem('newArticles' + currentLanguageCode, JSON.stringify(arr))\n      }\n\n    });\n  }\n  componentWillUpdate(prevProps) {\n    var  self  =  this;\n    const { currentLanguageCode } = this.props;\n    console.log(prevProps.currentLanguageCode , currentLanguageCode)\n    if(prevProps.currentLanguageCode !== currentLanguageCode){\n      let locName = 'newArticles' + currentLanguageCode\n\n      if(localStorage.getItem(locName)){\n        self.setState({ catalog: JSON.parse(localStorage.getItem(locName))})\n      }\n\n      service.getCatalog({leng: prevProps.currentLanguageCode}).then(function (result) {\n        if (result) {\n          self.setState({ catalog: result, loading: true })\n  \n          let arr = newArticlesSorting(self.state.catalog)\n          self.setState({NewArticles: arr, loading: false})\n          localStorage.setItem('newArticles' + currentLanguageCode, JSON.stringify(arr))\n        }\n      });\n    }\n  }\n\n  catalog_finded(temp) {\n    temp= temp.toLowerCase()\n    let str = this.state.find ? this.state.find.toLowerCase() : null\n    return temp.indexOf(str) !== -1 ? \"catalog__finded-style\" : \"\"\n  }\n\n\n  findClick(){\n    this.setState({find: document.getElementById(\"catalog__input-find-group\").value})\n  }\n\n\n  modStyle(second) {\n    if (second[2] && second[2] === \"unmod\") {\n      return \"catalog__second-level-unmod\"\n    } else if (second[2] && second[2] === \"noDisplay\") {\n      return \"catalog__second-level-delete\"\n    } else {\n      return \"catalog_second-level\"\n    }\n  }\n\n\n  modInfo(second) {\n    if(second[2] && second[2] === \"unmod\"){\n      return \" (На проверке)\"\n    } else if(second[2] && second[2] === \"noDisplay\"){}\n  }  \n\n  \n  render() {\n    const { strings, currentLanguageCode } = this.props;\n    console.log(currentLanguageCode)\n    if (this.state.loading) {\n      return (\n        <>\n        <div className=\"cssload-container\">\n            <div className=\"cssload-zenith\"></div>\n        </div>\n        </>\n      )\n    \n    } else return(   \n      <div className=\"catalog\">\n\n        <h1> {strings[\"newArticles\"]} </h1>\n        <FindForm onAdd={this.FindFormHandler} strings={strings[\"find\"]}/>\n          <div/>\n          { \n            this.state.NewArticles.map( global  =>\n                <div className=\"newArticlesList__article\" key={global}> \n                    <Link className=\"newArticlesList__link\" to={\"/Article/\"+global[0][3]}>{global[0][2]}</Link> \n                    <p className=\"newArticlesList__context\">{global[0][1]} ({global[0][0]})</p>\n\n                    <h6 className=\"newArticlesList__context\"> рейтинг:  { global[0][5]}</h6>\n                </div>\n            )\n          }\n\n      </div>\n    );\n  }\n}\nconst NewArticles = connect()(multilanguage(PRENewArticles));\nexport default NewArticles;"]},"metadata":{},"sourceType":"module"}