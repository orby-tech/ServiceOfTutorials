{"ast":null,"code":"import _classCallCheck from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/oem/React/ServiceOfTutorials/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Link}from'react-router-dom';import Service from'./Service';import{multilanguage,changeLanguage,loadLanguages}from\"redux-multilanguage\";import{connect}from'react-redux';import{FindForm}from'./FindCatalog.tsx';var service=new Service();function sortfunction(a,b){return a[0][5]-b[0][5];}var topArticlesSorting=function topArticlesSorting(catalog){var arr=[];catalog.map(function(global){return global.splice(1).map(function(first){return first[1].forEach(function(second){if(second[1]&&second[2]!==\"noDisplay\"&&second[3]>=0){arr.push([[global[0],first[0]].concat(second)]);}});});});arr.sort(sortfunction);arr.reverse();return arr;};var PRETopArticles=/*#__PURE__*/function(_Component){_inherits(PRETopArticles,_Component);var _super=_createSuper(PRETopArticles);function PRETopArticles(props){var _this;_classCallCheck(this,PRETopArticles);_this=_super.call(this,props);_this.findClick=_this.findClick.bind(_assertThisInitialized(_this));var currentLanguageCode=_this.props.currentLanguageCode;var topArticles=[];if(localStorage.getItem('topArticles'+currentLanguageCode)){topArticles=JSON.parse(localStorage.getItem('topArticles'+currentLanguageCode));}_this.state={catalog:[],find:null,loading:false,topArticles:topArticles};return _this;}_createClass(PRETopArticles,[{key:\"componentDidMount\",value:function componentDidMount(){var currentLanguageCode=this.props.currentLanguageCode;var self=this;service.getCatalog({leng:currentLanguageCode}).then(function(result){self.setState({catalog:result,loading:true});localStorage.setItem('catalog',JSON.stringify(result));var arr=topArticlesSorting(result);self.setState({topArticles:arr,loading:false});localStorage.setItem('topArticles'+currentLanguageCode,JSON.stringify(arr));});}},{key:\"componentWillUpdate\",value:function componentWillUpdate(prevProps){var self=this;var currentLanguageCode=this.props.currentLanguageCode;if(prevProps.currentLanguageCode!==currentLanguageCode){var locName='topArticles'+prevProps.currentLanguageCode;if(localStorage.getItem(locName)){self.setState({catalog:JSON.parse(localStorage.getItem(locName))});}service.getCatalog({leng:prevProps.currentLanguageCode}).then(function(result){if(result){self.setState({catalog:result,loading:true});var arr=topArticlesSorting(self.state.catalog);self.setState({topArticles:arr,loading:false});localStorage.setItem(locName,JSON.stringify(arr));}});}}},{key:\"catalog_finded\",value:function catalog_finded(temp){temp=temp.toLowerCase();var str=this.state.find?this.state.find.toLowerCase():null;return temp.indexOf(str)!==-1?\"catalog__finded-style\":\"\";}},{key:\"findClick\",value:function findClick(){this.setState({find:document.getElementById(\"catalog__input-find-group\").value});}},{key:\"modStyle\",value:function modStyle(second){if(second[2]&&second[2]===\"unmod\"){return\"catalog__second-level-unmod\";}else if(second[2]&&second[2]===\"noDisplay\"){return\"catalog__second-level-delete\";}else{return\"catalog_second-level\";}}},{key:\"modInfo\",value:function modInfo(second){if(second[2]&&second[2]===\"unmod\"){return\" (На проверке)\";}else if(second[2]&&second[2]===\"noDisplay\"){}}},{key:\"render\",value:function render(){var _this$props=this.props,strings=_this$props.strings,currentLanguageCode=_this$props.currentLanguageCode;if(this.state.loading){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"cssload-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"cssload-zenith\"})));}else return/*#__PURE__*/React.createElement(\"div\",{className:\"catalog\"},/*#__PURE__*/React.createElement(\"h1\",null,\" \",strings[\"popular\"],\" \"),/*#__PURE__*/React.createElement(FindForm,{onAdd:this.FindFormHandler,strings:strings[\"find\"]}),/*#__PURE__*/React.createElement(\"div\",null),this.state.topArticles.map(function(global){return/*#__PURE__*/React.createElement(\"div\",{className:\"newArticlesList__article\",key:global},/*#__PURE__*/React.createElement(Link,{className:\"newArticlesList__link\",to:\"/Article/\"+global[0][3]},global[0][2]),/*#__PURE__*/React.createElement(\"p\",{className:\"newArticlesList__context\"},global[0][1],\" (\",global[0][0],\")\"),/*#__PURE__*/React.createElement(\"p\",{className:\"newArticlesList__context\"},\"\\u0440\\u0435\\u0439\\u0442\\u0438\\u043D\\u0433:  \",global[0][5]));}));}}]);return PRETopArticles;}(Component);var TopArticles=connect()(multilanguage(PRETopArticles));export default TopArticles;","map":{"version":3,"sources":["/home/oem/React/ServiceOfTutorials/frontend/src/TopArticlesList.js"],"names":["React","Component","Link","Service","multilanguage","changeLanguage","loadLanguages","connect","FindForm","service","sortfunction","a","b","topArticlesSorting","catalog","arr","map","global","splice","first","forEach","second","push","concat","sort","reverse","PRETopArticles","props","findClick","bind","currentLanguageCode","topArticles","localStorage","getItem","JSON","parse","state","find","loading","self","getCatalog","leng","then","result","setState","setItem","stringify","prevProps","locName","temp","toLowerCase","str","indexOf","document","getElementById","value","strings","FindFormHandler","TopArticles"],"mappings":"0yBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAkC,OAAlC,CAEA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAQC,CAAAA,OAAR,KAAuB,WAAvB,CACA,OAASC,aAAT,CAAwBC,cAAxB,CAAwCC,aAAxC,KAA4D,qBAA5D,CACA,OAAUC,OAAV,KAAyB,aAAzB,CAEA,OAASC,QAAT,KAAyB,mBAAzB,CAEA,GAAOC,CAAAA,OAAO,CAAK,GAAKN,CAAAA,OAAL,EAAnB,CAGA,QAASO,CAAAA,YAAT,CAAsBC,CAAtB,CAAyBC,CAAzB,CAA2B,CACzB,MAAQD,CAAAA,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,EAAUC,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAlB,CACD,CACD,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACC,OAAD,CAAa,CACtC,GAAIC,CAAAA,GAAG,CAAG,EAAV,CACAD,OAAO,CAACE,GAAR,CAAa,SAAAC,MAAM,QACjBA,CAAAA,MAAM,CAACC,MAAP,CAAc,CAAd,EAAiBF,GAAjB,CAAsB,SAAAG,KAAK,QACvBA,CAAAA,KAAK,CAAC,CAAD,CAAL,CAASC,OAAT,CAAkB,SAAAC,MAAM,CAAK,CACzB,GAAGA,MAAM,CAAC,CAAD,CAAN,EAAaA,MAAM,CAAC,CAAD,CAAN,GAAc,WAA3B,EAA0CA,MAAM,CAAC,CAAD,CAAN,EAAa,CAA1D,CAA4D,CACpDN,GAAG,CAACO,IAAJ,CAAS,CAAC,CAACL,MAAM,CAAC,CAAD,CAAP,CAAYE,KAAK,CAAC,CAAD,CAAjB,EAAsBI,MAAtB,CAA6BF,MAA7B,CAAD,CAAT,EACP,CACJ,CAJD,CADuB,EAA3B,CADiB,EAAnB,EASFN,GAAG,CAACS,IAAJ,CAASd,YAAT,EACAK,GAAG,CAACU,OAAJ,GACE,MAAOV,CAAAA,GAAP,CACD,CAdD,C,GAeMW,CAAAA,c,gHACJ,wBAAYC,KAAZ,CAAmB,gDACjB,uBAAMA,KAAN,EACA,MAAKC,SAAL,CAAiB,MAAKA,SAAL,CAAeC,IAAf,+BAAjB,CAFiB,GAITC,CAAAA,mBAJS,CAIe,MAAKH,KAJpB,CAITG,mBAJS,CAKjB,GAAIC,CAAAA,WAAW,CAAG,EAAlB,CACA,GAAGC,YAAY,CAACC,OAAb,CAAqB,cAAgBH,mBAArC,CAAH,CAA6D,CAC3DC,WAAW,CAAGG,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,cAAgBH,mBAArC,CAAX,CAAd,CACD,CACD,MAAKM,KAAL,CAAa,CACXtB,OAAO,CAAE,EADE,CAEXuB,IAAI,CAAE,IAFK,CAGXC,OAAO,CAAE,KAHE,CAIXP,WAAW,CAAEA,WAJF,CAAb,CATiB,aAelB,C,wFAGkB,IACTD,CAAAA,mBADS,CACe,KAAKH,KADpB,CACTG,mBADS,CAEjB,GAAKS,CAAAA,IAAI,CAAK,IAAd,CACA9B,OAAO,CAAC+B,UAAR,CAAmB,CAAEC,IAAI,CAAEX,mBAAR,CAAnB,EAAkDY,IAAlD,CAAuD,SAAUC,MAAV,CAAkB,CACvEJ,IAAI,CAACK,QAAL,CAAc,CAAE9B,OAAO,CAAE6B,MAAX,CAAmBL,OAAO,CAAE,IAA5B,CAAd,EACAN,YAAY,CAACa,OAAb,CAAqB,SAArB,CAAgCX,IAAI,CAACY,SAAL,CAAeH,MAAf,CAAhC,EACE,GAAI5B,CAAAA,GAAG,CAAGF,kBAAkB,CAAC8B,MAAD,CAA5B,CACAJ,IAAI,CAACK,QAAL,CAAc,CAACb,WAAW,CAAEhB,GAAd,CAAmBuB,OAAO,CAAC,KAA3B,CAAd,EACAN,YAAY,CAACa,OAAb,CAAqB,cAAgBf,mBAArC,CAA0DI,IAAI,CAACY,SAAL,CAAe/B,GAAf,CAA1D,EACH,CAND,EAOD,C,gEACmBgC,S,CAAW,CAC7B,GAAKR,CAAAA,IAAI,CAAK,IAAd,CAD6B,GAErBT,CAAAA,mBAFqB,CAEG,KAAKH,KAFR,CAErBG,mBAFqB,CAG7B,GAAGiB,SAAS,CAACjB,mBAAV,GAAkCA,mBAArC,CAAyD,CACvD,GAAIkB,CAAAA,OAAO,CAAG,cAAgBD,SAAS,CAACjB,mBAAxC,CACA,GAAGE,YAAY,CAACC,OAAb,CAAqBe,OAArB,CAAH,CAAiC,CAC/BT,IAAI,CAACK,QAAL,CAAc,CAAE9B,OAAO,CAAEoB,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqBe,OAArB,CAAX,CAAX,CAAd,EACD,CAEDvC,OAAO,CAAC+B,UAAR,CAAmB,CAACC,IAAI,CAAEM,SAAS,CAACjB,mBAAjB,CAAnB,EAA0DY,IAA1D,CAA+D,SAAUC,MAAV,CAAkB,CAC/E,GAAIA,MAAJ,CAAY,CACVJ,IAAI,CAACK,QAAL,CAAc,CAAE9B,OAAO,CAAE6B,MAAX,CAAmBL,OAAO,CAAE,IAA5B,CAAd,EAEA,GAAIvB,CAAAA,GAAG,CAAGF,kBAAkB,CAAC0B,IAAI,CAACH,KAAL,CAAWtB,OAAZ,CAA5B,CACAyB,IAAI,CAACK,QAAL,CAAc,CAACb,WAAW,CAAEhB,GAAd,CAAmBuB,OAAO,CAAE,KAA5B,CAAd,EACAN,YAAY,CAACa,OAAb,CAAqBG,OAArB,CAA8Bd,IAAI,CAACY,SAAL,CAAe/B,GAAf,CAA9B,EACD,CACF,CARD,EASD,CACF,C,sDAEckC,I,CAAM,CACnBA,IAAI,CAAEA,IAAI,CAACC,WAAL,EAAN,CACA,GAAIC,CAAAA,GAAG,CAAG,KAAKf,KAAL,CAAWC,IAAX,CAAkB,KAAKD,KAAL,CAAWC,IAAX,CAAgBa,WAAhB,EAAlB,CAAkD,IAA5D,CACA,MAAOD,CAAAA,IAAI,CAACG,OAAL,CAAaD,GAAb,IAAsB,CAAC,CAAvB,CAA2B,uBAA3B,CAAqD,EAA5D,CACD,C,6CAGU,CACT,KAAKP,QAAL,CAAc,CAACP,IAAI,CAAEgB,QAAQ,CAACC,cAAT,CAAwB,2BAAxB,EAAqDC,KAA5D,CAAd,EACD,C,0CAGQlC,M,CAAQ,CACf,GAAIA,MAAM,CAAC,CAAD,CAAN,EAAaA,MAAM,CAAC,CAAD,CAAN,GAAc,OAA/B,CAAwC,CACtC,MAAO,6BAAP,CACD,CAFD,IAEO,IAAIA,MAAM,CAAC,CAAD,CAAN,EAAaA,MAAM,CAAC,CAAD,CAAN,GAAc,WAA/B,CAA4C,CACjD,MAAO,8BAAP,CACD,CAFM,IAEA,CACL,MAAO,sBAAP,CACD,CACF,C,wCAGOA,M,CAAQ,CACd,GAAGA,MAAM,CAAC,CAAD,CAAN,EAAaA,MAAM,CAAC,CAAD,CAAN,GAAc,OAA9B,CAAsC,CACpC,MAAO,gBAAP,CACD,CAFD,IAEO,IAAGA,MAAM,CAAC,CAAD,CAAN,EAAaA,MAAM,CAAC,CAAD,CAAN,GAAc,WAA9B,CAA0C,CAAE,CACpD,C,uCAGQ,iBACkC,KAAKM,KADvC,CACC6B,OADD,aACCA,OADD,CACU1B,mBADV,aACUA,mBADV,CAEP,GAAI,KAAKM,KAAL,CAAWE,OAAf,CAAwB,CACtB,mBACE,qDACA,2BAAK,SAAS,CAAC,mBAAf,eACI,2BAAK,SAAS,CAAC,gBAAf,EADJ,CADA,CADF,CAQD,CATD,IASO,oBACL,2BAAK,SAAS,CAAC,SAAf,eAEE,kCAAMkB,OAAO,CAAC,SAAD,CAAb,KAFF,cAGE,oBAAC,QAAD,EAAU,KAAK,CAAE,KAAKC,eAAtB,CAAuC,OAAO,CAAED,OAAO,CAAC,MAAD,CAAvD,EAHF,cAII,+BAJJ,CAMM,KAAKpB,KAAL,CAAWL,WAAX,CAAuBf,GAAvB,CAA4B,SAAAC,MAAM,qBAC9B,2BAAK,SAAS,CAAC,0BAAf,CAA0C,GAAG,CAAEA,MAA/C,eACI,oBAAC,IAAD,EAAM,SAAS,CAAC,uBAAhB,CAAwC,EAAE,CAAE,YAAYA,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAAxD,EAAuEA,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAAvE,CADJ,cAEI,yBAAG,SAAS,CAAC,0BAAb,EAAyCA,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAAzC,MAAyDA,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAAzD,KAFJ,cAGI,yBAAG,SAAS,CAAC,0BAAb,kDAAoDA,MAAM,CAAC,CAAD,CAAN,CAAU,CAAV,CAApD,CAHJ,CAD8B,EAAlC,CANN,CADK,CAkBR,C,4BA9G0BhB,S,EAgH7B,GAAMyD,CAAAA,WAAW,CAAGnD,OAAO,GAAGH,aAAa,CAACsB,cAAD,CAAhB,CAA3B,CACA,cAAegC,CAAAA,WAAf","sourcesContent":["import React, { Component }  from 'react';\n\nimport { Link } from 'react-router-dom';\nimport  Service  from  './Service';\nimport { multilanguage, changeLanguage, loadLanguages} from \"redux-multilanguage\";\nimport  { connect } from 'react-redux'\n\nimport { FindForm } from './FindCatalog.tsx';\n\nconst  service  =  new  Service();\n\n\nfunction sortfunction(a, b){\n  return (a[0][5] - b[0][5])\n}\nconst topArticlesSorting = (catalog) => {\n  let arr = []\n  catalog.map( global=>\n    global.splice(1).map( first => \n        first[1].forEach( second  => {\n            if(second[1] && second[2] !== \"noDisplay\" && second[3] >= 0){\n                    arr.push([[global[0], first[0]].concat(second)])\n            }\n        })   \n    )\n)\narr.sort(sortfunction)\narr.reverse()\n  return arr\n}\nclass PRETopArticles extends Component{\n  constructor(props) {\n    super(props);\n    this.findClick = this.findClick.bind(this)\n\n    const { currentLanguageCode } = this.props;\n    let topArticles = []\n    if(localStorage.getItem('topArticles' + currentLanguageCode)){\n      topArticles = JSON.parse(localStorage.getItem('topArticles' + currentLanguageCode))\n    }\n    this.state = {\n      catalog: [],\n      find: null,\n      loading: false,\n      topArticles: topArticles,\n    }\n  }\n\n\n  componentDidMount(){\n    const { currentLanguageCode } = this.props;\n    var  self  =  this;\n    service.getCatalog({ leng: currentLanguageCode }).then(function (result) {\n      self.setState({ catalog: result ,loading: true})\n      localStorage.setItem('catalog', JSON.stringify(result))\n        let arr = topArticlesSorting(result)\n        self.setState({topArticles: arr, loading:false})\n        localStorage.setItem('topArticles' + currentLanguageCode, JSON.stringify(arr))\n    });\n  }\n  componentWillUpdate(prevProps) {\n    var  self  =  this;\n    const { currentLanguageCode } = this.props;\n    if(prevProps.currentLanguageCode !== currentLanguageCode){\n      let locName = 'topArticles' + prevProps.currentLanguageCode\n      if(localStorage.getItem(locName)){\n        self.setState({ catalog: JSON.parse(localStorage.getItem(locName))})\n      }\n\n      service.getCatalog({leng: prevProps.currentLanguageCode}).then(function (result) {\n        if (result) {\n          self.setState({ catalog: result, loading: true })\n  \n          let arr = topArticlesSorting(self.state.catalog)\n          self.setState({topArticles: arr, loading: false})\n          localStorage.setItem(locName, JSON.stringify(arr))\n        }\n      });\n    }\n  }\n\n  catalog_finded(temp) {\n    temp= temp.toLowerCase()\n    let str = this.state.find ? this.state.find.toLowerCase() : null\n    return temp.indexOf(str) !== -1 ? \"catalog__finded-style\" : \"\"\n  }\n\n\n  findClick(){\n    this.setState({find: document.getElementById(\"catalog__input-find-group\").value})\n  }\n\n\n  modStyle(second) {\n    if (second[2] && second[2] === \"unmod\") {\n      return \"catalog__second-level-unmod\"\n    } else if (second[2] && second[2] === \"noDisplay\") {\n      return \"catalog__second-level-delete\"\n    } else {\n      return \"catalog_second-level\"\n    }\n  }\n\n\n  modInfo(second) {\n    if(second[2] && second[2] === \"unmod\"){\n      return \" (На проверке)\"\n    } else if(second[2] && second[2] === \"noDisplay\"){}\n  }  \n\n  \n  render() {\n    const { strings, currentLanguageCode } = this.props;\n    if (this.state.loading) {\n      return (\n        <>\n        <div className=\"cssload-container\">\n            <div className=\"cssload-zenith\"></div>\n        </div>\n        </>\n      )\n    \n    } else return(   \n      <div className=\"catalog\">\n\n        <h1> {strings[\"popular\"]} </h1>\n        <FindForm onAdd={this.FindFormHandler} strings={strings[\"find\"]}/>\n          <div/>\n          { \n            this.state.topArticles.map( global  =>\n                <div className=\"newArticlesList__article\" key={global}> \n                    <Link className=\"newArticlesList__link\" to={\"/Article/\"+global[0][3]}>{global[0][2]}</Link> \n                    <p className=\"newArticlesList__context\">{global[0][1]} ({global[0][0]})</p>\n                    <p className=\"newArticlesList__context\">рейтинг:  { global[0][5]}</p>\n                </div>\n            )\n          }\n\n      </div>\n    );\n  }\n}\nconst TopArticles = connect()(multilanguage(PRETopArticles));\nexport default TopArticles;"]},"metadata":{},"sourceType":"module"}