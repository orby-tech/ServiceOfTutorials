{"ast":null,"code":"var _jsxFileName = \"/home/oem/ServiceOfTutorials/frontend/src/CreateArticle.tsx\";\nimport React, { Component } from 'react';\nimport Service from './Service';\nimport ArticleCreator from './ArticleCreator';\nconst service = new Service();\n\nclass CreateArticle extends Component {\n  constructor(props) {\n    super(props);\n    this.first_change = this.first_change.bind(this);\n    this.second_change = this.second_change.bind(this);\n    let catalog = [];\n\n    if (localStorage.getItem('catalog')) {\n      catalog = JSON.parse(localStorage.getItem('catalog'));\n    }\n\n    this.state = {\n      catalog: catalog,\n      status: null,\n      first_value: \"\",\n      second_value: \"selected\",\n      second_steck: [],\n      type: \"selected\",\n      temp_type: \"selected\",\n      constructor: false,\n      new_article: [],\n      redaction: -1,\n      no_link: \"create-article__type-new-block-no-link form-control create-article__input\",\n      loading: true\n    };\n  }\n\n  componentDidMount() {\n    var self = this;\n    service.getCatalog().then(function (result) {\n      self.setState({\n        catalog: result,\n        loading: false\n      });\n    });\n  }\n\n  first_change(event) {\n    this.setState({\n      first_value: event.target.value\n    });\n    let target;\n\n    for (let i = 0; i < this.state.catalog.length; i++) {\n      if (event.target.value === this.state.catalog[i][0]) {\n        target = this.state.catalog[i].slice(1);\n        break;\n      }\n    }\n\n    this.setState({\n      second_steck: target\n    });\n  }\n\n  second_change(event) {\n    this.setState({\n      second_value: event.target.value\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const {\n      match: {\n        params\n      }\n    } = this.props;\n\n    if (params.pk !== this.state.opend) {\n      this.setState({\n        opend: params.pk\n      });\n    }\n  }\n\n  publicateArticle() {\n    if (this.state.new_article[0][1] !== \"header\") {\n      alert(\"Статья должна начинаться с Заголовока\");\n    } else {\n      this.setState({\n        loading: true\n      });\n      var self = this;\n      var raw = {\n        \"type\": this.state.first_value,\n        \"under_type\": this.state.second_value.toString(),\n        \"article\": this.state.new_article\n      };\n      service.createArticle(raw).then(function (result) {\n        self.setState({\n          loading: false\n        });\n        alert(\"Статья добавлена, и на ходится на модерации,спасибо, удачного дня!)\");\n        window.location.reload();\n      });\n    }\n  }\n\n  render() {\n    let styleOfSecondChange = this.state.second_steck.length !== 0 ? \"custom-select mr-sm-2 create-article__input\" : \"create-article__non-display\";\n    let styleOfCreatorBlock = this.state.second_value !== \"selected\" ? \"\" : \"create-article__non-display\";\n\n    if (this.state.loading) {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"cssload-container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"cssload-zenith\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }\n      })));\n    } else return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"create-article__container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      className: \"custom-select mr-sm-2 create-article__input\",\n      id: \"inlineFormCustomSelect create-article__input\",\n      onChange: this.first_change,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"selected\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }\n    }, \"\\u041D\\u0430\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435\"), this.state.catalog.map(global => /*#__PURE__*/React.createElement(\"option\", {\n      value: global[0],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 15\n      }\n    }, global[0]))), /*#__PURE__*/React.createElement(\"select\", {\n      className: styleOfSecondChange,\n      id: \"inlineFormCustomSelect create-article__input\",\n      onChange: this.second_change,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"selected\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }\n    }, \"\\u0422\\u0435\\u043C\\u0430\"), this.state.second_steck.map(global => /*#__PURE__*/React.createElement(\"option\", {\n      value: global[0],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 15\n      }\n    }, global[0]))), /*#__PURE__*/React.createElement(\"div\", {\n      className: styleOfCreatorBlock,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ArticleCreator, {\n      type: this.state.first_value,\n      under_type: this.state.second_value,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 13\n      }\n    })));\n  }\n\n}\n\nexport default CreateArticle;","map":{"version":3,"sources":["/home/oem/ServiceOfTutorials/frontend/src/CreateArticle.tsx"],"names":["React","Component","Service","ArticleCreator","service","CreateArticle","constructor","props","first_change","bind","second_change","catalog","localStorage","getItem","JSON","parse","state","status","first_value","second_value","second_steck","type","temp_type","new_article","redaction","no_link","loading","componentDidMount","self","getCatalog","then","result","setState","event","target","value","i","length","slice","componentDidUpdate","prevProps","prevState","match","params","pk","opend","publicateArticle","alert","raw","toString","createArticle","window","location","reload","render","styleOfSecondChange","styleOfCreatorBlock","map","global"],"mappings":"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","sourcesContent":["import  React, { Component }  from 'react';\n\nimport  Service  from  './Service';\nimport  ArticleCreator  from  './ArticleCreator';\n\nconst  service  =  new  Service();\n\ninterface ParentState {\n  catalog:any[];\n}\n\nclass CreateArticle extends Component<{}, ParentState>{\n\n  constructor(props) {\n    super(props);\n    this.first_change = this.first_change.bind(this)\n    this.second_change = this.second_change.bind(this)\n   \n\n\n    let catalog = []\n    if(localStorage.getItem('catalog')){\n      catalog = JSON.parse(localStorage.getItem('catalog'))\n    }\n    this.state = {\n      catalog:  catalog,\n      status:null,\n      first_value: \"\",\n      second_value: \"selected\",\n      second_steck: [],\n      type: \"selected\",\n      temp_type: \"selected\",\n      constructor: false,\n      new_article: [],\n      redaction: -1,\n      no_link: \"create-article__type-new-block-no-link form-control create-article__input\",\n      loading: true\n    };\n  }\n  componentDidMount(){\n    var  self  =  this;\n    service.getCatalog().then(function (result) {\n      self.setState({ catalog: result, loading: false })\n    })\n\n  }\n  \n  first_change (event) {\n    this.setState({first_value: event.target.value});\n    let target \n    for (let i = 0; i<this.state.catalog.length; i++) {\n      if(event.target.value === this.state.catalog[i][0]) {\n        target = this.state.catalog[i].slice(1)\n        break;\n      }\n    }\n    this.setState({second_steck: target})\n  }\n  second_change (event) {\n    this.setState({second_value: event.target.value});\n  }\n  \n  componentDidUpdate(prevProps, prevState) {\n    const { match: { params } } = this.props;\n    if (params.pk !== this.state.opend) {\n      this.setState({opend: params.pk});\n    }\n  }\n\n  publicateArticle(){\n\n    if (this.state.new_article[0][1] !== \"header\") {\n      alert(\"Статья должна начинаться с Заголовока\")\n    } else{\n      this.setState({loading: true})\n      var  self  =  this;\n\n      var raw = {\n        \"type\": this.state.first_value,\n        \"under_type\": this.state.second_value.toString(),\n        \"article\": this.state.new_article\n      }\n      service.createArticle(raw).then(function (result) {\n        self.setState({loading:false})\n        alert(\"Статья добавлена, и на ходится на модерации,спасибо, удачного дня!)\")\n        window.location.reload();\n      });\n    }\n  }\n\n  render() {\n    let styleOfSecondChange = this.state.second_steck.length !== 0\n                      ? \"custom-select mr-sm-2 create-article__input\" \n                      : \"create-article__non-display\"\n    let styleOfCreatorBlock = this.state.second_value !== \"selected\"\n                      ? \"\"\n                      : \"create-article__non-display\"\n   \n\n\n    if (this.state.loading) {\n      return (\n        <>\n        <div className=\"cssload-container\">\n            <div className=\"cssload-zenith\"></div>\n        </div>\n        </>\n      )\n    \n    }  else return(\n      <div className=\"create-article__container\">\n\n\n\n\n        <select  className=\"custom-select mr-sm-2 create-article__input\" \n                 id = \"inlineFormCustomSelect create-article__input\" \n                 onChange={this.first_change}>\n          <option value=\"selected\">Направление</option>\n\n          {this.state.catalog.map( global  =>\n              <option value={global[0]}>{global[0]}</option>\n          )}\n        </select>\n\n\n\n        <select  className={styleOfSecondChange}\n                 id = \"inlineFormCustomSelect create-article__input\" \n                 onChange={this.second_change}>\n          <option value=\"selected\">Тема</option>\n\n          {this.state.second_steck.map( global  =>\n              <option value={global[0]}>{global[0]}</option>\n          )}\n        </select>\n        <div className={styleOfCreatorBlock}>\n            <ArticleCreator type={this.state.first_value} under_type={this.state.second_value} />\n        </div>\n\n      </div>\n    );\n  }\n}\n\nexport default CreateArticle;\n"]},"metadata":{},"sourceType":"module"}